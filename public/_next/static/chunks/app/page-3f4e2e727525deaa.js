(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7653:function(n,t,e){Promise.resolve().then(e.bind(e,6813))},3626:function(n,t,e){"use strict";e.d(t,{k:function(){return tW},x:function(){return rj}}),n=e.hmd(n);var r,u,a,i,o,l,c,f,s,h,v,m,p,w,g,E,_,d,T,A={compose:function(n){return function(t){return function(e){return n(t(e))}}}},S=function(n){return n.identity},P={identity:function(n){return n},Semigroupoid0:function(){return A}},N=function(n){return function(t){return function(e){return n(e)(t)}}},M=void 0,F=function(){function n(){}return n.value=new n,n}(),R=function(n){return n.map},x={map:function(n){return function(t){for(var e=t.length,r=Array(e),u=0;u<e;u++)r[u]=n(t[u]);return r}}},y=function(n){return n.apply},I=function(n){var t=y(n),e=R(n.Functor0());return function(n){return function(r){return function(u){return t(e(n)(r))(u)}}}},k=function(n){return n.pure},L=function(n){return n.bind},b={append:function(n){return function(t){return n+t}}},O=function(n){return n.append};String.fromCharCode(65535);var Y=function(n){return function(t){return function(e){return function(r){return function(u){return r<u?n:r===u?t:e}}}}},C=function(n){return function(t){return n===t}},D={eq:C},B={eq:C},U=function(n){return n.eq},X=function(){function n(){}return n.value=new n,n}(),j=function(){function n(){}return n.value=new n,n}(),q=function(){function n(){}return n.value=new n,n}(),H={add:function(n){return function(t){return n+t|0}},zero:0,mul:function(n){return function(t){return n*t|0}},one:1},G={sub:function(n){return function(t){return n-t|0}},Semiring0:function(){return H}},$={compare:Y(X.value)(q.value)(j.value),Eq0:function(){return D}},z={compare:Y(X.value)(q.value)(j.value),Eq0:function(){return B}},Q=function(n){return n.compare},V={show:function(n){return n.toString()}},W=function(n){return n.show},Z=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),J=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),K=function(){function n(n,t){this.value0=n,this.value1=t}return n.create=function(t){return function(e){return new n(t,e)}},n}(),nn=function(){function n(){}return n.value=new n,n}(),nt=function(n){return n.from},ne=function(){function n(){}return n.value=new n,n}(),nr=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),nu={map:function(n){return function(t){return t instanceof nr?new nr(n(t.value0)):ne.value}}},na=R(nu),ni=function(n){var t=U(n);return{eq:function(n){return function(e){return n instanceof ne&&e instanceof ne||n instanceof nr&&e instanceof nr&&t(n.value0)(e.value0)}}}},no={apply:function(n){return function(t){if(n instanceof nr)return na(n.value0)(t);if(n instanceof ne)return ne.value;throw Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[n.constructor.name,t.constructor.name])}},Functor0:function(){return nu}},nl={pure:nr.create,Apply0:function(){return no}},nc=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),nf=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),ns={map:function(n){return function(t){if(t instanceof nc)return new nc(t.value0);if(t instanceof nf)return new nf(n(t.value0));throw Error("Failed pattern match at Data.Either (line 0, column 0 - line 0, column 0): "+[t.constructor.name])}}},nh=R(ns),nv={apply:function(n){return function(t){if(n instanceof nc)return new nc(n.value0);if(n instanceof nf)return nh(n.value0)(t);throw Error("Failed pattern match at Data.Either (line 70, column 1 - line 72, column 30): "+[n.constructor.name,t.constructor.name])}},Functor0:function(){return ns}},nm={bind:(i=function(n){return function(t){return new nc(n)}},function(n){return function(t){if(t instanceof nc)return i(t.value0);if(t instanceof nf)return n(t.value0);throw Error("Failed pattern match at Data.Either (line 208, column 1 - line 208, column 64): "+[i.constructor.name,n.constructor.name,t.constructor.name])}})(function(n){return function(t){return t(n)}}),Apply0:function(){return nv}},np={pure:nf.create,Apply0:function(){return nv}},nw={Applicative0:function(){return np},Bind1:function(){return nm}},ng={div:function(n){return function(t){return 0===t?0:t>0?Math.floor(n/t):-Math.floor(-(n/t))}},mod:function(n){return function(t){if(0===t)return 0;var e=Math.abs(t);return(n%e+e)%e}}},nE={ff:!1,tt:!0,implies:function(n){return function(t){return nE.disj(nE.not(n))(t)}},conj:function(n){return function(t){return n&&t}},disj:function(n){return function(t){return n||t}},not:function(n){return!n}},n_=function(n){return n.mempty},nd=function(){function n(n,t){this.value0=n,this.value1=t}return n.create=function(t){return function(e){return new n(t,e)}},n}(),nT=function(n){var t=n.conj;return{append:function(n){return function(e){return t(n)(e)}}}},nA=function(n){var t=nT(n);return{mempty:n.tt,Semigroup0:function(){return t}}},nS=function(n){return n},nP=function(n){return n.foldr},nN=function(n){return n.foldl},nM=function(n){var t=nP(n);return function(n){var e=O(n.Semigroup0()),r=n_(n);return function(n){return t(function(t){return function(r){return e(n(t))(r)}})(r)}}},nF={foldr:function(n){return function(t){return function(e){for(var r=t,u=e.length,a=u-1;a>=0;a--)r=n(e[a])(r);return r}}},foldl:function(n){return function(t){return function(e){for(var r=t,u=e.length,a=0;a<u;a++)r=n(r)(e[a]);return r}}},foldMap:function(n){return nM(nF)(n)}},nR=(o=nr.create,function(n){return function(t){var e=RegExp("^[\\+\\-]?"+(t<11?"[0-"+(t-1).toString()+"]":11===t?"[0-9a]":"[0-9a-"+String.fromCharCode(86+t)+"]")+"+$","i");return function(r){if(!e.test(r))return n;var u=parseInt(r,t);return(0|u)===u?o(u):n}}})(ne.value)(10),nx=function(n){var t=null;return function(){return void 0===n||(t=n(),n=void 0),t}},ny=function(n){return n()},nI=function(){function n(n){return[n]}function t(n){return function(t){return[n,t]}}function e(n){return function(t){return function(e){return[n,t,e]}}}function r(n){return function(t){return n.concat(t)}}return function(u){return function(a){return function(i){return function(o){return function(l){return function c(f,s){switch(s-f){case 0:return i([]);case 1:return a(n)(o(l[f]));case 2:return u(a(t)(o(l[f])))(o(l[f+1]));case 3:return u(u(a(e)(o(l[f])))(o(l[f+1])))(o(l[f+2]));default:var h=f+2*Math.floor((s-f)/4);return u(a(r)(c(f,h)))(c(h,s))}}(0,l.length)}}}}}}(),nk={map:function(n){return function(t){return n(t)}}},nL={apply:function(n){return function(t){return n(t)}},Functor0:function(){return nk}},nb={bind:function(n){return function(t){return t(n)}},Apply0:function(){return nL}},nO={pure:function(n){return n},Apply0:function(){return nL}},nY={Applicative0:function(){return nO},Bind1:function(){return nb}},nC=S(P),nD=function(n){return n.traverse},nB=function(n){var t=nD(n);return function(n){return t(n)(nC)}},nU={traverse:function(n){var t=n.Apply0();return nI(y(t))(R(t.Functor0()))(k(n))},sequence:function(n){return nB(nU)(n)},Functor0:function(){return x},Foldable1:function(){return nF}},nX=function(n){return n.sequence},nj={map:function(n){return function(t){return nx(function(e){return n(ny(t))})}}},nq={apply:function(n){return function(t){return nx(function(e){return ny(n)(ny(t))})}},Functor0:function(){return nj}},nH=function(n){var t=L(n.Bind1()),e=k(n.Applicative0());return function(n){return function(r){return t(n)(function(n){return t(r)(function(t){return e(n(t))})})}}},nG=S(P),n$=function(){function n(){}return n.value=new n,n}(),nz=function(){function n(n,t){this.value0=n,this.value1=t}return n.create=function(t){return function(e){return new n(t,e)}},n}(),nQ={map:function(n){var t;return t=n$.value,function(e){for(var r,u=t,a=!1;!a;)r=function(t,r){if(r instanceof nz&&r.value1 instanceof nz&&r.value1.value1 instanceof nz){u=new nz(r,t),e=r.value1.value1.value1;return}return a=!0,function(e){for(var r,u=t,a=!1;!a;)r=function(t,r){if(t instanceof nz&&t.value0 instanceof nz&&t.value0.value1 instanceof nz&&t.value0.value1.value1 instanceof nz){u=t.value1,e=new nz(n(t.value0.value0),new nz(n(t.value0.value1.value0),new nz(n(t.value0.value1.value1.value0),r)));return}return a=!0,r}(u,e);return r}(r instanceof nz&&r.value1 instanceof nz&&r.value1.value1 instanceof n$?new nz(n(r.value0),new nz(n(r.value1.value0),n$.value)):r instanceof nz&&r.value1 instanceof n$?new nz(n(r.value0),n$.value):n$.value)}(u,e);return r}}},nV={foldr:function(n){return function(t){var e,r=(e=n$.value,function(n){for(var t,r=e,u=!1;!u;)t=function(t,e){if(e instanceof n$)return u=!0,t;if(e instanceof nz){r=new nz(e.value0,t),n=e.value1;return}throw Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[t.constructor.name,e.constructor.name])}(r,n);return t}),u=nN(nV)(N(n))(t);return function(n){return u(r(n))}}},foldl:function(n){return function(t){return function(e){for(var r,u=t,a=!1;!a;)r=function(t,r){if(r instanceof n$)return a=!0,t;if(r instanceof nz){u=n(t)(r.value0),e=r.value1;return}throw Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[r.constructor.name])}(u,e);return r}}},foldMap:function(n){var t=O(n.Semigroup0()),e=n_(n);return function(n){return nN(nV)(function(e){var r=t(e);return function(t){return r(n(t))}})(e)}}},nW=nN(nV),nZ=nP(nV),nJ={traverse:function(n){var t=n.Apply0(),e=R(t.Functor0()),r=I(t),u=k(n);return function(n){var t=e(nW(N(nz.create))(n$.value)),a=nW(function(t){var e=r(N(nz.create))(t);return function(t){return e(n(t))}})(u(n$.value));return function(n){return t(a(n))}}},sequence:function(n){return nD(nJ)(n)(nG)},Functor0:function(){return nQ},Foldable1:function(){return nV}},nK={unfoldr1:function(n){return function(t){return function(e){for(var r,u=t,a=!1;!a;)r=function(t,r){var i=n(t);if(i.value1 instanceof nr){u=i.value1.value0,e=new nz(i.value0,r);return}if(i.value1 instanceof ne)return a=!0,nW(N(nz.create))(n$.value)(new nz(i.value0,r));throw Error("Failed pattern match at Data.List.Types (line 135, column 22 - line 137, column 61): "+[i.constructor.name])}(u,e);return r}(n$.value)}}},n0=nN(nV),n1=function(n){if(n instanceof n$)return ne.value;if(n instanceof nz)return new nr(n.value1);throw Error("Failed pattern match at Data.List (line 245, column 1 - line 245, column 43): "+[n.constructor.name])},n2=(l=n$.value,function(n){for(var t,e=l,r=!1;!r;)t=function(t,u){if(u instanceof n$)return r=!0,t;if(u instanceof nz){e=new nz(u.value0,t),n=u.value1;return}throw Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): "+[t.constructor.name,u.constructor.name])}(e,n);return t}),n3=n0(function(n){return function(t){return n+1|0}})(0),n4=function(n){if(n instanceof n$)return ne.value;if(n instanceof nz)return new nr(n.value0);throw Error("Failed pattern match at Data.List (line 230, column 1 - line 230, column 22): "+[n.constructor.name])},n5=function(){function n(){}return n.value=new n,n}(),n6=function(){function n(n,t,e,r,u,a){this.value0=n,this.value1=t,this.value2=e,this.value3=r,this.value4=u,this.value5=a}return n.create=function(t){return function(e){return function(r){return function(u){return function(a){return function(i){return new n(t,e,r,u,a,i)}}}}}},n}(),n8=function(){function n(){}return n.value=new n,n}(),n7=function(){function n(n,t,e){this.value0=n,this.value1=t,this.value2=e}return n.create=function(t){return function(e){return function(r){return new n(t,e,r)}}},n}(),n9=function(){function n(n,t){this.value0=n,this.value1=t}return n.create=function(t){return function(e){return new n(t,e)}},n}(),tn=function(n,t,e,r){if(e instanceof n5){if(r instanceof n5)return new n6(1,1,n,t,e,r);if(r instanceof n6)return new n6(1+r.value0|0,1+r.value1|0,n,t,e,r);throw Error("Failed pattern match at Data.Map.Internal (line 680, column 5 - line 684, column 39): "+[r.constructor.name])}if(e instanceof n6){if(r instanceof n5)return new n6(1+e.value0|0,1+e.value1|0,n,t,e,r);if(r instanceof n6)return new n6(1+(e.value0>r.value0?e.value0:r.value0)|0,(1+e.value1|0)+r.value1|0,n,t,e,r);throw Error("Failed pattern match at Data.Map.Internal (line 686, column 5 - line 690, column 68): "+[r.constructor.name])}throw Error("Failed pattern match at Data.Map.Internal (line 678, column 32 - line 690, column 68): "+[e.constructor.name])},tt=N(n9.create)(n8.value),te=function(n){return function(t){return new n6(1,1,n,t,n5.value,n5.value)}},tr=(c=function(n){if(n instanceof n5)return 0;if(n instanceof n6)return n.value0;throw Error("Failed pattern match at Data.Map.Internal (line 735, column 12 - line 737, column 26): "+[n.constructor.name])},f=function(n,t,e,r,u,a,i){return a instanceof n6&&a.value0>c(i)?tn(a.value2,a.value3,tn(n,t,e,a.value4),tn(r,u,a.value5,i)):tn(r,u,tn(n,t,e,a),i)},s=function(n,t,e,r,u,a,i){return a instanceof n6&&c(u)<=a.value0?tn(a.value2,a.value3,tn(e,r,u,a.value4),tn(n,t,a.value5,i)):tn(e,r,u,tn(n,t,a,i))},function(n,t,e,r){if(e instanceof n5)return r instanceof n5?te(n)(t):r instanceof n6&&r.value0>1?f(n,t,e,r.value2,r.value3,r.value4,r.value5):tn(n,t,e,r);if(e instanceof n6){if(r instanceof n6){if(r.value0>(e.value0+1|0))return f(n,t,e,r.value2,r.value3,r.value4,r.value5);if(e.value0>(r.value0+1|0))return s(n,t,e.value2,e.value3,e.value4,e.value5,r)}return r instanceof n5&&e.value0>1?s(n,t,e.value2,e.value3,e.value4,e.value5,r):tn(n,t,e,r)}throw Error("Failed pattern match at Data.Map.Internal (line 695, column 40 - line 716, column 34): "+[e.constructor.name])}),tu=function(n){var t=Q(n);return function(n){return function(e){for(var r,u=!1;!u;)r=function(r){if(r instanceof n5)return u=!0,ne.value;if(r instanceof n6){var a=t(n)(r.value2);if(a instanceof X){e=r.value4;return}if(a instanceof j){e=r.value5;return}if(a instanceof q)return u=!0,new nr(r.value3);throw Error("Failed pattern match at Data.Map.Internal (line 281, column 7 - line 284, column 22): "+[a.constructor.name])}throw Error("Failed pattern match at Data.Map.Internal (line 278, column 8 - line 284, column 22): "+[r.constructor.name])}(e);return r}}},ta=(h=function(n){return function(t){for(var e,r=n,u=!1;!u;)e=function(n,e){if(e instanceof n5)return u=!0,n;if(e instanceof n6){if(e.value5 instanceof n5){r=new n7(e.value2,e.value3,n),t=e.value4;return}r=new n7(e.value2,e.value3,new n9(e.value5,n)),t=e.value4;return}throw Error("Failed pattern match at Data.Map.Internal (line 929, column 13 - line 936, column 48): "+[e.constructor.name])}(r,t);return e}},function(n){return function(t){return function(e){for(var r,u=!1;!u;)r=function(r){if(r instanceof n8)return u=!0,t(M);if(r instanceof n7)return u=!0,n(r.value0,r.value1,r.value2);if(r instanceof n9){e=h(r.value1)(r.value0);return}throw Error("Failed pattern match at Data.Map.Internal (line 918, column 8 - line 924, column 20): "+[r.constructor.name])}(e);return r}}})(function(n,t,e){return new nr(new nd(new nd(n,t),e))})(function(n){return ne.value}),ti=function(n){var t=Q(n);return function(n){return function(e){var r=function(u){if(u instanceof n5)return te(n)(e);if(u instanceof n6){var a=t(n)(u.value2);if(a instanceof X)return tr(u.value2,u.value3,r(u.value4),u.value5);if(a instanceof j)return tr(u.value2,u.value3,u.value4,r(u.value5));if(a instanceof q)return new n6(u.value0,u.value1,n,e,u.value4,u.value5);throw Error("Failed pattern match at Data.Map.Internal (line 469, column 7 - line 472, column 35): "+[a.constructor.name])}throw Error("Failed pattern match at Data.Map.Internal (line 466, column 8 - line 472, column 35): "+[u.constructor.name])};return r}}},to=n5.value,tl=function(n){return n};Array.prototype.fill;var tc=function(){function n(n,t){this.head=n,this.tail=t}var t={};function e(t){return function(e){return new n(t,e)}}return function(n,r){return function(n){for(var e=[],r=0,u=n;u!==t;)e[r++]=u.head,u=u.tail;return e}(n(e)(t)(r))}}(),tf=function(n){return function(t){return function(e){return n(t,e)}}},ts=(v=nN(nF),function(n){var t=O(n.Semigroup0()),e=n_(n);return function(n){return function(r){return v(function(e){return function(r){return e.init?{init:!1,acc:r}:{init:!1,acc:t(e.acc)(t(n)(r))}}})({init:!0,acc:e})(r).acc}}}),th=(m=function(n,t,e){for(var r=t.length<e.length?t.length:e.length,u=Array(r),a=0;a<r;a++)u[a]=n(t[a])(e[a]);return u},function(n){return function(t){return function(e){return m(n,t,e)}}}),tv=tf(function(n,t){for(var e=t.length,r=0;r<e;r++)if(n(t[r]))return!0;return!1}),tm=n.require,tp=function(){try{return void 0===tm?void 0:tm("util")}catch(n){return}}();!function(){if("undefined"!=typeof performance)performance;else if(tm)try{tm("perf_hooks").performance}catch(n){}}();var tw=function(n){return n()},tg=function(n){throw Error(n)},tE=ts({mempty:"",Semigroup0:function(){return b}}),t_=function(n){return tw(function(){var t={value:n};return{get:function(n){return tw(function(){return t.value})},set:function(n){return tw(function(){t.value=n})}}})},td=function(n){return tg(tE("\n")(["","==[ BUG ]=================================================================",n,"==========================================================================",""]))},tT=function(n){if(n instanceof nr)return n.value0;if(n instanceof ne)return td("fromJust failed");throw Error("Failed pattern match at Util (line 44, column 1 - line 44, column 36): "+[n.constructor.name])},tA=function(n,t,e){var r,u=0;return function(a){if(2===u)return r;if(1===u)throw ReferenceError(n+" was needed before it finished initializing (module "+t+", line "+a+")",t,a);return u=1,r=e(),u=2,r}},tS=W({show:function(n){if(n)return"true";if(!n)return"false";throw Error("Failed pattern match at Data.Show (line 29, column 1 - line 31, column 23): "+[n.constructor.name])}}),tP=W(V),tN=nP(nV),tM=(r=nV.foldMap,function(n){return nS(r(nA(n)))})(nE),tF=k(nl),tR=k(np),tx=ng.div,ty=ng.mod,tI=R(x),tk=ti($),tL=k({pure:function(n){return nx(function(t){return n})},Apply0:function(){return nq}}),tb=L(nm),tO=O({append:function(n){return function(t){return nZ(nz.create)(t)(n)}}}),tY=tu($),tC=function(){function n(){}return n.value=new n,n}(),tD=function(){function n(){}return n.value=new n,n}(),tB=function(){function n(){}return n.value=new n,n}(),tU=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),tX=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),tj=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),tq=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),tH=function(n){if(n instanceof tX)return tS(n.value0);if(n instanceof tU)return tP(n.value0);if(n instanceof tj)return tN(function(n){return function(t){return"(cons "+tH(n)+" "+t+")"}})("nil")(n.value0);if(n instanceof tq)return"<function>";throw Error("Failed pattern match at Evaluate (line 150, column 18 - line 154, column 29): "+[n.constructor.name])},tG=function(n){return function(t){var e,r=new nd(n,t);return r.value0 instanceof tU&&r.value1 instanceof tU||r.value0 instanceof tX&&r.value1 instanceof tX?r.value0.value0===r.value1.value0:r.value0 instanceof tj&&r.value1 instanceof tj&&tM(function(n){return n})((e=r.value0.value0,function(n){return n2(function(t){for(var r,u=e,a=n,i=!1;!i;)r=function(n,e,r){if(n instanceof n$||e instanceof n$)return i=!0,r;if(n instanceof nz&&e instanceof nz){u=n.value1,a=e.value1,t=new nz(tG(n.value0)(e.value0),r);return}throw Error("Failed pattern match at Data.List (line 779, column 3 - line 779, column 21): "+[n.constructor.name,e.constructor.name,r.constructor.name])}(u,a,t);return r}(n$.value))})(r.value1.value0))}},t$=function(n){return n instanceof tj?n.value0:td("assertValint failed")},tz=function(n){return n instanceof tU?n.value0:td("assertValint failed")},tQ=function(n){return n instanceof tX?n.value0:td("assertValint failed")},tV=function(n){return function(t){var e=new nd(t.label,tI(tl)(t.kids));if("TOP"===e.value0&&1===e.value1.length||"PARENTERM"===e.value0&&1===e.value1.length)return tV(n)(e.value1[0]);if("FUN"===e.value0&&2===e.value1.length)return tR(new tq(function(r){return tV(tk(t.dataa)(tL(new nf(r)))(n))(e.value1[1])}));if("FUN_NOANN"===e.value0&&1===e.value1.length)return tR(new tq(function(r){return tV(tk(t.dataa)(tL(new nf(r)))(n))(e.value1[0])}));if("LET"===e.value0&&3===e.value1.length){var r=tA("vDef","Evaluate",function(){return tV(tk(t.dataa)(nx(function(n){return r(85)}))(n))(e.value1[1])}),u=r(85);return tV(tk(t.dataa)(tL(u))(n))(e.value1[2])}if("LET_NOANN"===e.value0&&2===e.value1.length){var r=tA("vDef","Evaluate",function(){return tV(tk(t.dataa)(nx(function(n){return r(88)}))(n))(e.value1[0])}),u=r(88);return tV(tk(t.dataa)(tL(u))(n))(e.value1[1])}if("APP"===e.value0&&2===e.value1.length)return tb(tV(n)(e.value1[0]))(function(t){return tb(tV(n)(e.value1[1]))(function(n){return(t instanceof tq?t.value0:td("assertValint failed"))(n)})});if("NAME"===e.value0&&0===e.value1.length){var a,i="true"===(a=t.dataa)?tF(new tX(!0)):"false"===a?tF(new tX(!1)):"not"===a?tF(new tq(function(n){return tR(new tX(!tQ(n)))})):ne.value;if(i instanceof nr)return tR(i.value0)}return"NAME"===e.value0&&0===e.value1.length&&"nil"===t.dataa?tR(new tj(n$.value)):"NAME"===e.value0&&0===e.value1.length&&"cons"===t.dataa?tR(new tq(function(n){return tR(new tq(function(t){return tR(new tj(new nz(n,t$(t))))}))})):"NAME"===e.value0&&0===e.value1.length&&"length"===t.dataa?tR(new tq(function(n){return tR(new tU(n3(t$(n))))})):"NAME"===e.value0&&0===e.value1.length&&"append"===t.dataa?tR(new tq(function(n){return tR(new tq(function(t){return tR(new tj(tO(t$(n))(t$(t))))}))})):"NAME"===e.value0&&0===e.value1.length&&"head"===t.dataa?tR(new tq(function(n){return tR(tT(n4(t$(n))))})):"NAME"===e.value0&&0===e.value1.length&&"tail"===t.dataa?tR(new tq(function(n){return tR(new tj(tT(n1(t$(n)))))})):"NAME"===e.value0&&0===e.value1.length&&"index"===t.dataa?tR(new tq(function(n){return tR(new tq(function(t){var e;return tR(tT((e=t$(n),function(n){for(var t,r=e,u=!1;!u;)t=function(t,e){if(t instanceof n$)return u=!0,ne.value;if(t instanceof nz&&0===e)return u=!0,new nr(t.value0);if(t instanceof nz){r=t.value1,n=e-1|0;return}throw Error("Failed pattern match at Data.List (line 281, column 1 - line 281, column 44): "+[t.constructor.name,e.constructor.name])}(r,n);return t})(tz(t))))}))})):"NAME"===e.value0&&0===e.value1.length?ny(tT(tY(t.dataa)(n))):"HOLE"===e.value0&&0===e.value1.length?new nc(tC.value):"IF"===e.value0&&3===e.value1.length?tb(tV(n)(e.value1[0]))(function(t){return tQ(t)?tV(n)(e.value1[1]):tV(n)(e.value1[2])}):"INFIX_EXPRESSION"===e.value0&&2===e.value1.length?tb(tV(n)(e.value1[0]))(function(r){return tb(tV(n)(e.value1[1]))(function(n){var e;return tR(("+"===(e=t.dataa)?function(n){return function(t){return new tU(tz(n)+tz(t)|0)}}:"-"===e?function(n){return function(t){return new tU(tz(n)-tz(t)|0)}}:"*"===e?function(n){return function(t){return new tU(tz(n)*tz(t)|0)}}:"/"===e?function(n){return function(t){return new tU(tx(tz(n))(tz(t)))}}:"%"===e?function(n){return function(t){return new tU(ty(tz(n))(tz(t)))}}:"^"===e?function(n){return function(t){var e;return new tU((e=tz(n),function(n){return 0|Math.pow(e,n)})(tz(t)))}}:"<"===e?function(n){return function(t){return new tX(tz(n)<tz(t))}}:">"===e?function(n){return function(t){return new tX(tz(n)>tz(t))}}:"<="===e?function(n){return function(t){return new tX(tz(n)<=tz(t))}}:">="===e?function(n){return function(t){return new tX(tz(n)>=tz(t))}}:"&&"===e?function(n){return function(t){return new tX(tQ(n)&&tQ(t))}}:"||"===e?function(n){return function(t){return new tX(tQ(n)||tQ(t))}}:td("evalInfix case not found: "+e))(r)(n))})}):"EQUALS"===e.value0&&2===e.value1.length?tb(tV(n)(e.value1[0]))(function(t){return tb(tV(n)(e.value1[1]))(function(n){return tR(new tX(tG(t)(n)))})}):"MATCH"===e.value0&&3===e.value1.length?tb(tV(n)(e.value1[0]))(function(r){var u=t$(r);if(u instanceof n$)return tV(n)(e.value1[1]);if(u instanceof nz)return tV(tk(t.dataa)(tL(new nf(u.value0)))(tk(t.dataa2)(tL(new nf(new tj(u.value1))))(n)))(e.value1[2]);throw Error("Failed pattern match at Evaluate (line 119, column 13 - line 121, column 128): "+[u.constructor.name])}):"INTEGER"===e.value0?tR(new tU(tT(nR(t.dataa)))):td("eval case fail: label was "+t.label)}},tW=function(n){var t=tV(to)(n);if(t instanceof nc){if(t.value0 instanceof tC)return"Error: hole";if(t.value0 instanceof tD)return"Error: type boundary";if(t.value0 instanceof tB)return"Error: unbound variable";throw Error("Failed pattern match at Evaluate (line 31, column 19 - line 34, column 50): "+[t.value0.constructor.name])}if(t instanceof nf)return tH(t.value0);throw Error("Failed pattern match at Evaluate (line 30, column 18 - line 35, column 32): "+[t.constructor.name])},tZ=function(n){var t=U(n);return{"genericEq'":function(n){return function(e){return t(n)(e)}}}},tJ=function(n){return n["genericEq'"]},tK=function(n){var t=tJ(n);return{"genericEq'":function(n){return function(e){return t(n)(e)}}}},t0=function(n){var t=tJ(n);return function(n){var e=tJ(n);return{"genericEq'":function(n){return function(r){return n instanceof Z&&r instanceof Z?t(n.value0)(r.value0):n instanceof J&&r instanceof J&&e(n.value0)(r.value0)}}}}},t1=function(n){var t=nt(n);return function(n){var e=tJ(n);return function(n){return function(r){return e(t(n))(t(r))}}}},t2=function(n){var t=Q(n);return{"genericCompare'":function(n){return function(e){return t(n)(e)}}}},t3=function(n){return n["genericCompare'"]},t4=function(n){var t=t3(n);return{"genericCompare'":function(n){return function(e){return t(n)(e)}}}},t5=function(n){var t=t3(n);return function(n){var e=t3(n);return{"genericCompare'":function(n){return function(r){if(n instanceof Z&&r instanceof Z)return t(n.value0)(r.value0);if(n instanceof J&&r instanceof J)return e(n.value0)(r.value0);if(n instanceof Z&&r instanceof J)return X.value;if(n instanceof J&&r instanceof Z)return j.value;throw Error("Failed pattern match at Data.Ord.Generic (line 19, column 1 - line 23, column 39): "+[n.constructor.name,r.constructor.name])}}}}},t6=function(n){var t=nt(n);return function(n){var e=t3(n);return function(n){return function(r){return e(t(n))(t(r))}}}},t8=O({append:function(n){return function(t){return 0===n.length?t:0===t.length?n:n.concat(t)}}}),t7=function(n){var t=W(n);return{genericShowArgs:function(n){return[t(n)]}}},t9=function(n){var t=n.genericShowArgs;return function(n){var e=n.reflectSymbol;return{"genericShow'":function(n){var r=e(F.value),u=t(n);return 0===u.length?r:"("+t8([r])(u).join(" ")+")"}}}},en=function(n){return n["genericShow'"]},et=function(n){var t=en(n);return function(n){var e=en(n);return{"genericShow'":function(n){if(n instanceof Z)return t(n.value0);if(n instanceof J)return e(n.value0);throw Error("Failed pattern match at Data.Show.Generic (line 26, column 1 - line 28, column 40): "+[n.constructor.name])}}}},ee=function(n){var t=nt(n);return function(n){var e=en(n);return function(n){return e(t(n))}}},er=W(V),eu=R(x),ea=function(){function n(n,t){this.value0=n,this.value1=t}return n.create=function(t){return function(e){return new n(t,e)}},n}(),ei=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),eo=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),el=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),ec=function(){function n(n,t){this.value0=n,this.value1=t}return n.create=function(t){return function(e){return new n(t,e)}},n}(),ef={to:function(n){if(n instanceof Z)return new ea(n.value0.value0,n.value0.value1);if(n instanceof J)return new ei(n.value0);throw Error("Failed pattern match at Data.Expr (line 93, column 1 - line 93, column 34): "+[n.constructor.name])},from:function(n){if(n instanceof ea)return new Z(new K(n.value0,n.value1));if(n instanceof ei)return new J(n.value0);throw Error("Failed pattern match at Data.Expr (line 93, column 1 - line 93, column 34): "+[n.constructor.name])}},es=t1(ef)(t0(tK((p=tJ(tZ(ni(D))),function(n){var t=tJ(n);return{"genericEq'":function(n){return function(e){return p(n.value0)(e.value0)&&t(n.value1)(e.value1)}}}})(tZ(B))))(tK(tZ(D)))),eh=t6(ef)(t5(t4((E=t3(t2((w=Q($),g=ni($.Eq0()),{compare:function(n){return function(t){if(n instanceof ne&&t instanceof ne)return q.value;if(n instanceof ne)return X.value;if(t instanceof ne)return j.value;if(n instanceof nr&&t instanceof nr)return w(n.value0)(t.value0);throw Error("Failed pattern match at Data.Maybe (line 0, column 0 - line 0, column 0): "+[n.constructor.name,t.constructor.name])}},Eq0:function(){return g}}))),function(n){var t=t3(n);return{"genericCompare'":function(n){return function(e){var r=E(n.value0)(e.value0);return r instanceof q?t(n.value1)(e.value1):r}}}})(t2(z))))(t4(t2($)))),ev={eq:function(n){return function(t){return es(n)(t)}}},em={compare:function(n){return function(t){return eh(n)(t)}},Eq0:function(){return ev}},ep=tu(em),ew=t_(0),eg=function(n){return function(t){return function(e){if(e.value0 instanceof eo){var r=ep(e.value0.value0)(t);if(r instanceof ne)return new ec(new eo(e.value0.value0),[]);if(r instanceof nr)return r.value0;throw Error("Failed pattern match at Data.Expr (line 172, column 18 - line 174, column 26): "+[r.constructor.name])}if(e.value0 instanceof el)return new ec(new el(e.value0.value0),eu(eg(n)(t))(e.value1));throw Error("Failed pattern match at Data.Expr (line 171, column 30 - line 175, column 70): "+[e.constructor.name])}}},eE=function(n){return function(t){return new ec(new el(n),t)}},e_=function(n){var t=ew.get(M);return ew.set(t+1|0),t},ed=function(n){return new ec(new eo(n),[])},eT=function(n){return new ea(new nr(n),e_(M))},eA=function(n){return""===n},eS=R(x),eP=function(){function n(n,t){this.value0=n,this.value1=t}return n.create=function(t){return function(e){return new n(t,e)}},n}(),eN=function(n){return function(t){var e,r,u;return e=t(),r=eS(eT)(n),new eP((u=e(eS(ed)(r))).value0,u.value1)}},eM=t9({genericShowArgs:function(n){return[]}}),eF=tK({"genericEq'":function(n){return function(n){return!0}}}),eR=t0(eF),ex=eR(eF),ey=t4({"genericCompare'":function(n){return function(n){return q.value}}}),eI=t5(ey),ek=eI(ey),eL=k(nl),eb=R(x),eO=function(n){if(n instanceof ea&&n.value0 instanceof ne)return"?"+er(n.value1);if(n instanceof ea&&n.value0 instanceof nr)return"?"+n.value0.value0+"#"+er(n.value1);if(n instanceof ei)return"??"+n.value0;throw Error("Failed pattern match at Data.Expr (line 97, column 1 - line 100, column 41): "+[n.constructor.name])},eY=k(np),eC=function(){function n(){}return n.value=new n,n}(),eD=function(){function n(){}return n.value=new n,n}(),eB=function(){function n(){}return n.value=new n,n}(),eU=function(){function n(){}return n.value=new n,n}(),eX=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),ej=function(){function n(){}return n.value=new n,n}(),eq=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),eH=function(){function n(){}return n.value=new n,n}(),eG=function(){function n(){}return n.value=new n,n}(),e$=function(){function n(n,t){this.value0=n,this.value1=t}return n.create=function(t){return function(e){return new n(t,e)}},n}(),ez=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),eQ=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),eV={to:function(n){if(n instanceof Z)return eB.value;if(n instanceof J&&n.value0 instanceof Z)return eU.value;if(n instanceof J&&n.value0 instanceof J&&n.value0.value0 instanceof Z)return new eX(n.value0.value0.value0);if(n instanceof J&&n.value0 instanceof J&&n.value0.value0 instanceof J&&n.value0.value0.value0 instanceof Z)return ej.value;if(n instanceof J&&n.value0 instanceof J&&n.value0.value0 instanceof J&&n.value0.value0.value0 instanceof J&&n.value0.value0.value0.value0 instanceof Z)return new eq(n.value0.value0.value0.value0.value0);if(n instanceof J&&n.value0 instanceof J&&n.value0.value0 instanceof J&&n.value0.value0.value0 instanceof J&&n.value0.value0.value0.value0 instanceof J&&n.value0.value0.value0.value0.value0 instanceof Z)return eH.value;if(n instanceof J&&n.value0 instanceof J&&n.value0.value0 instanceof J&&n.value0.value0.value0 instanceof J&&n.value0.value0.value0.value0 instanceof J&&n.value0.value0.value0.value0.value0 instanceof J)return eG.value;throw Error("Failed pattern match at Language (line 69, column 1 - line 69, column 36): "+[n.constructor.name])},from:function(n){if(n instanceof eB)return new Z(nn.value);if(n instanceof eU)return new J(new Z(nn.value));if(n instanceof eX)return new J(new J(new Z(n.value0)));if(n instanceof ej)return new J(new J(new J(new Z(nn.value))));if(n instanceof eq)return new J(new J(new J(new J(new Z(n.value0)))));if(n instanceof eH)return new J(new J(new J(new J(new J(new Z(nn.value))))));if(n instanceof eG)return new J(new J(new J(new J(new J(new J(nn.value))))));throw Error("Failed pattern match at Language (line 69, column 1 - line 69, column 36): "+[n.constructor.name])}},eW={to:function(n){if(n instanceof Z)return eC.value;if(n instanceof J)return eD.value;throw Error("Failed pattern match at Language (line 25, column 1 - line 25, column 35): "+[n.constructor.name])},from:function(n){if(n instanceof eC)return new Z(nn.value);if(n instanceof eD)return new J(nn.value);throw Error("Failed pattern match at Language (line 25, column 1 - line 25, column 35): "+[n.constructor.name])}},eZ=ee(eW)(et(eM({reflectSymbol:function(){return"Bool"}}))(eM({reflectSymbol:function(){return"Int"}}))),eJ=t1(eW)(ex),eK=t6(eW)(ek),e0={show:function(n){return eZ(n)}},e1=ee(eV)(et(eM({reflectSymbol:function(){return"TermSort"}}))(et(eM({reflectSymbol:function(){return"TypeSort"}}))(et(t9(t7({show:function(n){var t=n.length;return'"'+n.replace(/[\0-\x1F\x7F"\\]/g,function(e,r){switch(e){case'"':case"\\":return"\\"+e;case"\x07":return"\\a";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\v":return"\\v"}var u=r+1,a=u<t&&n[u]>="0"&&n[u]<="9"?"\\&":"";return"\\"+e.charCodeAt(0).toString(10)+a})+'"'}}))({reflectSymbol:function(){return"CtxConsSort"}}))(et(eM({reflectSymbol:function(){return"CtxNilSort"}}))(et(t9(t7(e0))({reflectSymbol:function(){return"DataType"}}))(et(eM({reflectSymbol:function(){return"Arrow"}}))(eM({reflectSymbol:function(){return"List"}})))))))),e2=W(e0),e3={show:function(n){return e1(n)}},e4={eq:function(n){return eJ(n)}},e5=t1(eV)(eR(eR(t0(tK(tZ(D)))(eR(t0(tK(tZ(e4)))(ex)))))),e6={eq:function(n){return e5(n)}},e8=t6(eV)(eI(eI(t5(t4(t2($)))(eI(t5(t4(t2({compare:function(n){return function(t){return eK(n)(t)}},Eq0:function(){return e4}})))(ek)))))),e7={compare:function(n){return function(t){return e8(n)(t)}},Eq0:function(){return e6}},e9={Eq0:function(){return e6},Ord1:function(){return e7},Show2:function(){return e3}},rn=function(n){return"("+n+")"},rt=function(n){var t=eE(new eq(eD.value))([]),e=eE(new eq(eC.value))([]);return"+"===n||"-"===n||"*"===n||"/"===n||"%"===n||"^"===n?{left:t,right:t,output:t}:"<"===n||">"===n||"<="===n||">="===n?{left:t,right:t,output:e}:"&&"===n||"||"===n?{left:e,right:e,output:e}:td("infixTypes error")},re=function(n){return function(t){return eA(n)?t:eA(t)?n:n+" "+t}},rr=function(n){if(n.value0 instanceof el){var t;return(t=new nd(n.value0.value0,eb(rr)(n.value1))).value0 instanceof eB&&2===t.value1.length?re("Term")(re(rn(t.value1[0]))(t.value1[1])):t.value0 instanceof eU&&1===t.value1.length?re("Type")(rn(t.value1[0])):t.value0 instanceof eX&&2===t.value1.length?t.value0.value0+":"+t.value1[0]+", "+t.value1[1]:t.value0 instanceof ej&&0===t.value1.length?"âˆ…":t.value0 instanceof eq&&0===t.value1.length?e2(t.value0.value0):t.value0 instanceof eH&&2===t.value1.length?rn(t.value1[0]+" -> "+t.value1[1]):t.value0 instanceof eG&&1===t.value1.length?re("List")(t.value1[0]):td("printSortImpl")}if(n.value0 instanceof eo)return eO(n.value0.value0);throw Error("Failed pattern match at Language (line 65, column 1 - line 65, column 28): "+[n.constructor.name])},ru={throwError:nc.create,Monad0:function(){return nw}},ra=function(n){return n.state},ri=function(n){var t=R(n);return{map:function(n){return function(e){return function(r){return t(function(t){return new nd(n(t.value0),t.value1)})(e(r))}}}}},ro=function(n){return{Applicative0:function(){return rf(n)},Bind1:function(){return rl(n)}}},rl=function(n){var t=L(n.Bind1());return{bind:function(n){return function(e){return function(r){return t(n(r))(function(n){return e(n.value0)(n.value1)})}}},Apply0:function(){return rc(n)}}},rc=function(n){var t=ri(n.Bind1().Apply0().Functor0());return{apply:nH(ro(n)),Functor0:function(){return t}}},rf=function(n){var t=k(n.Applicative0());return{pure:function(n){return function(e){return t(new nd(n,e))}},Apply0:function(){return rc(n)}}},rs=U(ev),rh=tu(em),rv=k(np),rm=ti(em),rp=L(nm),rw=nX(nU),rg=rw(np),rE=ru.throwError,r_=(_=k(nY.Applicative0()),d=ro(nY),{state:function(n){return function(t){return _(n(t))}},Monad0:function(){return d}}),rd=(T=ra(r_),function(n){return T(function(t){var e=n(t);return new nd(e,e)})}),rT=L(rl(nY)),rA=ra(r_)(function(n){return new nd(n,n)}),rS=rf(nY),rP=k(rS),rN=rw(rS),rM=R(x),rF=nX(nJ)(rS),rR=R(nQ),rx=(u=({unfoldr:function(n){return function(t){return function(e){for(var r,u=t,a=!1;!a;)r=function(t,r){var i=n(t);if(i instanceof ne)return a=!0,nW(N(nz.create))(n$.value)(r);if(i instanceof nr){u=i.value0.value1,e=new nz(i.value0.value0,r);return}throw Error("Failed pattern match at Data.List.Types (line 142, column 22 - line 144, column 52): "+[i.constructor.name])}(u,e);return r}(n$.value)}},Unfoldable10:function(){return nK}}).unfoldr(ta),function(n){return u(tt(n))}),ry=function(n){return function(t){return function(e){return function(r){if(r.value0 instanceof eo&&0===r.value1.length){var u=rh(r.value0.value0)(t);if(u instanceof nr)return ry(n)(t)(e)(u.value0)}return r.value0 instanceof eo&&0===r.value1.length?rs(r.value0.value0)(e):tv(ry(n)(t)(e))(r.value1)}}}},rI=function(n){var t=ry(n),e=U(n.Ord1().Eq0());return function(r){return function(u){return function(a){var i=new nd(u.value0,a.value0);if(i.value0 instanceof eo){var o=rh(i.value0.value0)(r.get(M));if(o instanceof nr)return rI(n)(r)(o.value0)(a)}return function(o){if(i.value1 instanceof eo){var l=rh(i.value1.value0)(r.get(M));if(l instanceof nr)return rI(n)(r)(u)(l.value0)}return i.value0 instanceof eo&&i.value1 instanceof eo&&rs(i.value0.value0)(i.value1.value0)?rv(u):i.value0 instanceof eo&&!t(r.get(M))(i.value0.value0)(a)?(r.set(rm(i.value0.value0)(a)(r.get(M))),rv(a)):i.value1 instanceof eo?rI(n)(r)(a)(u):i.value0 instanceof el&&i.value1 instanceof el&&e(i.value0.value0)(i.value1.value0)?rp(rg(th(rI(n)(r))(u.value1)(a.value1)))(function(n){return rv(new ec(new el(i.value0.value0),n))}):rE(M)}(0)}}}},rk=function(n){return function(t){return function(e){return rT(rA)(function(r){var u=rh(e)(r);if(u instanceof nr)return rP(u.value0);if(u instanceof ne)return rT(function(){var r=rh(e)(t);if(r instanceof ne)return rP(new ec(new eo(e),[]));if(r instanceof nr)return rT(rL(n)(t)(r.value0))(function(n){return rT(rd(rm(e)(n)))(function(){return rP(n)})});throw Error("Failed pattern match at Unification (line 35, column 22 - line 40, column 35): "+[r.constructor.name])}())(function(n){return rP(n)});throw Error("Failed pattern match at Unification (line 32, column 5 - line 41, column 23): "+[u.constructor.name])})}}},rL=function(n){return function(t){return function(e){return e.value0 instanceof eo?rk(n)(t)(e.value0.value0):rT(rN(rM(rL(n)(t))(e.value1)))(function(n){return rP(new ec(e.value0,n))})}}},rb=R(x),rO=eg(e9),rY=(a=rk(e9),function(n){var t;return(t=rT(rF(rR(function(t){return a(n)(t.value0)})(rx(n))))(function(){return rP(M)}),function(n){return nS(t(n))})(to).value1}),rC=rI(e9),rD=tf(tc)(nP(nV)),rB=function(n){return"("+(n.label+(" ["+(n.dataa+("]["+n.dataa2))))+"]"+rb(function(n){return rB(tl(n))})(n.kids).join(" ")+")"},rU=function(n){return n.value0 instanceof el&&n.value0.value0 instanceof eB&&2===n.value1.length?rr(n.value1[1]):td("printType: wasn't of right form: "+rr(n))},rX=function(n){return function(t){return function(e){return function(r){var u,a=function(t){return n.set(new nz({start_pos:r.start_pos,end_pos:r.end_pos,msg:t},n.get(M)))},i=(u=rO(rY(t.get(M)))(e),function(n){return function(t){return function(e){if("TOP"===n)return eY(eN(["x"])(function(){return function(n){if(1===n.length)return new nd([n[0]],n[0]);throw Error("Failed pattern match at Language (line 139, column 42 - line 142, column 6): "+[n.constructor.name])}}));if("PARENTERM"===n)return eY(eN(["x"])(function(){return function(n){if(1===n.length)return new nd([n[0]],n[0]);throw Error("Failed pattern match at Language (line 144, column 48 - line 147, column 6): "+[n.constructor.name])}}));if("PARENTYPE"===n)return eY(eN(["x"])(function(){return function(n){if(1===n.length)return new nd([n[0]],n[0]);throw Error("Failed pattern match at Language (line 149, column 48 - line 152, column 6): "+[n.constructor.name])}}));if("FUN"===n)return eY(eN(["gamma","a","b"])(function(){return function(n){if(3===n.length)return new nd([eE(eU.value)([n[1]]),eE(eB.value)([eE(new eX(t))([n[1],n[0]]),n[2]])],eE(eB.value)([n[0],eE(eH.value)([n[1],n[2]])]));throw Error("Failed pattern match at Language (line 154, column 56 - line 158, column 44): "+[n.constructor.name])}}));if("FUN_NOANN"===n)return eY(eN(["gamma","a","b"])(function(){return function(n){if(3===n.length)return new nd([eE(eB.value)([eE(new eX(t))([n[1],n[0]]),n[2]])],eE(eB.value)([n[0],eE(eH.value)([n[1],n[2]])]));throw Error("Failed pattern match at Language (line 160, column 62 - line 163, column 44): "+[n.constructor.name])}}));if("IF"===n)return eY(eN(["gamma","ty"])(function(){return function(n){if(2===n.length)return new nd([eE(eB.value)([n[0],eE(new eq(eC.value))([])]),eE(eB.value)([n[0],n[1]]),eE(eB.value)([n[0],n[1]])],eE(eB.value)([n[0],n[1]]));throw Error("Failed pattern match at Language (line 165, column 51 - line 170, column 32): "+[n.constructor.name])}}));if("APP"===n)return eY(eN(["gamma","a","b"])(function(){return function(n){if(3===n.length)return new nd([eE(eB.value)([n[0],eE(eH.value)([n[1],n[2]])]),eE(eB.value)([n[0],n[1]])],eE(eB.value)([n[0],n[2]]));throw Error("Failed pattern match at Language (line 172, column 56 - line 176, column 31): "+[n.constructor.name])}}));if("HOLE"===n)return eY(eN(["gamma","type"])(function(){return function(n){if(2===n.length)return new nd([eE(eU.value)([n[1]])],eE(eB.value)([n[0],n[1]]));throw Error("Failed pattern match at Language (line 178, column 55 - line 181, column 32): "+[n.constructor.name])}}));if("LET"===n)return eY(eN(["a","b","gamma"])(function(){return function(n){if(3===n.length)return new nd([eE(eU.value)([n[0]]),eE(eB.value)([eE(new eX(t))([n[0],n[2]]),n[0]]),eE(eB.value)([eE(new eX(t))([n[0],n[2]]),n[1]])],eE(eB.value)([n[2],n[1]]));throw Error("Failed pattern match at Language (line 183, column 56 - line 188, column 30): "+[n.constructor.name])}}));if("LET_NOANN"===n)return eY(eN(["a","b","gamma"])(function(){return function(n){if(3===n.length)return new nd([eE(eB.value)([eE(new eX(t))([n[0],n[2]]),n[0]]),eE(eB.value)([eE(new eX(t))([n[0],n[2]]),n[1]])],eE(eB.value)([n[2],n[1]]));throw Error("Failed pattern match at Language (line 190, column 62 - line 194, column 30): "+[n.constructor.name])}}));if("BOOL"===n)return eY(eN([])(function(){return function(n){if(0===n.length)return new nd([],eE(eU.value)([eE(new eq(eC.value))([])]));throw Error("Failed pattern match at Language (line 206, column 40 - line 209, column 42): "+[n.constructor.name])}}));if("INT"===n)return eY(eN([])(function(){return function(n){if(0===n.length)return new nd([],eE(eU.value)([eE(new eq(eD.value))([])]));throw Error("Failed pattern match at Language (line 211, column 39 - line 214, column 41): "+[n.constructor.name])}}));if("LIST"===n)return eY(eN(["type"])(function(){return function(n){if(1===n.length)return new nd([eE(eU.value)([n[0]])],eE(eU.value)([eE(eG.value)([n[0]])]));throw Error("Failed pattern match at Language (line 216, column 46 - line 219, column 35): "+[n.constructor.name])}}));if("ARROW_TYPE"===n)return eY(eN(["a","b"])(function(){return function(n){if(2===n.length)return new nd([eE(eU.value)([n[0]]),eE(eU.value)([n[1]])],eE(eU.value)([eE(eH.value)([n[0],n[1]])]));throw Error("Failed pattern match at Language (line 221, column 54 - line 224, column 38): "+[n.constructor.name])}}));if("IF"===n)return eY(eN(["gamma","type"])(function(){return function(n){if(2===n.length)return new nd([eE(eB.value)([n[0],eE(new eq(eC.value))([])]),eE(eB.value)([n[0],n[1]]),eE(eB.value)([n[0],n[1]])],eE(eB.value)([n[0],n[1]]));throw Error("Failed pattern match at Language (line 226, column 53 - line 231, column 34): "+[n.constructor.name])}}));if("NAME"===n){var r="true"===t||"false"===t?eL(eE(new eq(eC.value))([])):"not"===t?eL(eE(eH.value)([eE(new eq(eC.value))([]),eE(new eq(eC.value))([])])):ne.value;if(r instanceof nr)return eY(eN(["gamma"])(function(){return function(n){if(1===n.length)return new nd([],eE(eB.value)([n[0],r.value0]));throw Error("Failed pattern match at Language (line 233, column 79 - line 236, column 30): "+[n.constructor.name])}}))}return function(r){if("INTEGER"===n)return eY(eN(["gamma"])(function(){return function(n){if(1===n.length)return new nd([],eE(eB.value)([n[0],eE(new eq(eD.value))([])]));throw Error("Failed pattern match at Language (line 238, column 50 - line 241, column 47): "+[n.constructor.name])}}));if("INFIX_EXPRESSION"===n){var a=rt(t);return eY(eN(["gamma"])(function(){return function(n){if(1===n.length)return new nd([eE(eB.value)([n[0],a.left]),eE(eB.value)([n[0],a.right])],eE(eB.value)([n[0],a.output]));throw Error("Failed pattern match at Language (line 245, column 39 - line 248, column 35): "+[n.constructor.name])}}))}if("EQUALS"===n)return eY(eN(["gamma","type"])(function(){return function(n){if(2===n.length)return new nd([eE(eB.value)([n[0],n[1]]),eE(eB.value)([n[0],n[1]])],eE(eB.value)([n[0],eE(new eq(eC.value))([])]));throw Error("Failed pattern match at Language (line 250, column 57 - line 253, column 48): "+[n.constructor.name])}}));if("NAME"===n&&"nil"===t)return eY(eN(["gamma","type"])(function(){return function(n){if(2===n.length)return new nd([],eE(eB.value)([n[0],eE(eG.value)([n[1]])]));throw Error("Failed pattern match at Language (line 255, column 72 - line 258, column 41): "+[n.constructor.name])}}));if("NAME"===n&&"cons"===t)return eY(eN(["gamma","type"])(function(){return function(n){if(2===n.length)return new nd([],eE(eB.value)([n[0],eE(eH.value)([n[1],eE(eH.value)([eE(eG.value)([n[1]]),eE(eG.value)([n[1]])])])]));throw Error("Failed pattern match at Language (line 260, column 73 - line 263, column 81): "+[n.constructor.name])}}));if("NAME"===n&&"head"===t)return eY(eN(["gamma","type"])(function(){return function(n){if(2===n.length)return new nd([],eE(eB.value)([n[0],eE(eH.value)([eE(eG.value)([n[1]]),n[1]])]));throw Error("Failed pattern match at Language (line 265, column 73 - line 268, column 56): "+[n.constructor.name])}}));if("NAME"===n&&"tail"===t)return eY(eN(["gamma","type"])(function(){return function(n){if(2===n.length)return new nd([],eE(eB.value)([n[0],eE(eH.value)([eE(eG.value)([n[1]]),eE(eG.value)([n[1]])])]));throw Error("Failed pattern match at Language (line 270, column 73 - line 273, column 66): "+[n.constructor.name])}}));if("NAME"===n&&"index"===t)return eY(eN(["gamma","type"])(function(){return function(n){if(2===n.length)return new nd([],eE(eB.value)([n[0],eE(eH.value)([eE(eG.value)([n[1]]),eE(eH.value)([eE(new eq(eD.value))([]),n[1]])])]));throw Error("Failed pattern match at Language (line 275, column 74 - line 278, column 87): "+[n.constructor.name])}}));if("NAME"===n&&"length"===t)return eY(eN(["gamma","type"])(function(){return function(n){if(2===n.length)return new nd([],eE(eB.value)([n[0],eE(eH.value)([eE(eG.value)([n[1]]),eE(new eq(eD.value))([])])]));throw Error("Failed pattern match at Language (line 280, column 75 - line 283, column 72): "+[n.constructor.name])}}));if("NAME"===n&&"append"===t)return eY(eN(["gamma","type"])(function(){return function(n){if(2===n.length)return new nd([],eE(eB.value)([n[0],eE(eH.value)([eE(eG.value)([n[1]]),eE(eH.value)([eE(eG.value)([n[1]]),eE(eG.value)([n[1]])])])]));throw Error("Failed pattern match at Language (line 285, column 75 - line 288, column 91): "+[n.constructor.name])}}));if("NAME"===n){var a=u.value0 instanceof el&&u.value0.value0 instanceof eB&&2===u.value1.length?function(n){for(var e,r,u=!1;!u;)r=(e=n).value0 instanceof el&&e.value0.value0 instanceof eX&&2===e.value1.length?t===e.value0.value0.value0?(u=!0,eL(e.value1[0])):void(n=e.value1[1]):(u=!0,ne.value);return r}(u.value1[0]):td("bug in findInCtx: sort not right "+rr(u));if(a instanceof ne)return new nc(new eQ(t));if(a instanceof nr)return eY(eN(["gamma"])(function(){return function(n){if(1===n.length)return new nd([],eE(eB.value)([n[0],a.value0]));throw Error("Failed pattern match at Language (line 296, column 21 - line 298, column 59): "+[n.constructor.name])}}));throw Error("Failed pattern match at Language (line 291, column 13 - line 298, column 59): "+[a.constructor.name])}return"MATCH"===n?eY(eN(["gamma","type","outTy"])(function(){return function(n){if(3===n.length)return new nd([eE(eB.value)([n[0],eE(eG.value)([n[1]])]),eE(eB.value)([n[0],n[2]]),eE(eB.value)([eE(new eX(t))([n[1],eE(new eX(e))([eE(eG.value)([n[1]]),n[0]])]),n[2]])],eE(eB.value)([n[0],n[2]]));throw Error("Failed pattern match at Language (line 300, column 65 - line 305, column 34): "+[n.constructor.name])}})):td("language constructor not found: "+n)}(0)}}})(r.label)(r.dataa)(r.dataa2);if(i instanceof nc)return a(i.value0);if(i instanceof nf)return!function(){var n=rC(t)(i.value0.value1)(e);if(n instanceof nc)return a(new e$(i.value0.value1,e));if(n instanceof nf)return"HOLE"===r.label?a(new ez(i.value0.value1)):void 0;throw Error("Failed pattern match at Typecheck (line 71, column 21 - line 76, column 34): "+[n.constructor.name])}(),th(rX(n)(t))(i.value0.value0)(rb(tl)(r.kids)),M;throw Error("Failed pattern match at Typecheck (line 68, column 5 - line 79, column 17): "+[i.constructor.name])}}}},rj=function(n){var t;return(t="Typechecking ast: "+rB(n),function(n){return void 0!==tp?console.log(tp.inspect(t,{depth:null,colors:!0})):console.log(t),n({})})(function(t){var e=t_(n$.value),r=t_(to),u=new ec(new el(eB.value),[new ec(new el(ej.value),[]),new ec(new eo(eT("topty")),[])]);return rX(e)(r)(u)(n),rb(function(n){var t=rO(rY(r.get(M)));if(n.msg instanceof e$)return{severity:"error",msg:"Type error. Actual type: "+rU(t(n.msg.value0))+"   Expected type: "+rU(t(n.msg.value1)),start_pos:{line:n.start_pos.line,overallPos:n.start_pos.overallPos,offset:n.start_pos.offset+1},end_pos:{line:n.end_pos.line,overallPos:n.end_pos.overallPos,offset:n.end_pos.offset+1}};if(n.msg instanceof eQ)return{severity:"error",msg:"Unbound variable: "+n.msg.value0,start_pos:{line:n.start_pos.line,overallPos:n.start_pos.overallPos,offset:n.start_pos.offset+1},end_pos:{line:n.end_pos.line,overallPos:n.end_pos.overallPos,offset:n.end_pos.offset+1}};if(n.msg instanceof ez)return{severity:"warning",msg:"Hole with type: "+rU(t(n.msg.value0)),start_pos:{line:n.start_pos.line,overallPos:n.start_pos.overallPos,offset:n.start_pos.offset+1},end_pos:{line:n.end_pos.line,overallPos:n.end_pos.overallPos,offset:n.end_pos.offset+1}};throw Error("Failed pattern match at Typecheck (line 96, column 13 - line 114, column 21): "+[n.msg.constructor.name])})(rD(e.get(M)))})}},6813:function(n,t,e){"use strict";e.r(t),e.d(t,{default:function(){return nm}});var r,u,a=e(2913),i=e(9278),o=e.n(i),l=e(4380),c=e(4824),f=e(1884);function s(){let n=(0,f._)(["(?:()"],["(?:\\()"]);return s=function(){return n},n}function h(){let n=(0,f._)(["(?:))"],["(?:\\))"]);return h=function(){return n},n}function v(){let n=(0,f._)(["(?:let)"]);return v=function(){return n},n}function m(){let n=(0,f._)(["(?::)"]);return m=function(){return n},n}function p(){let n=(0,f._)(["(?:=)"]);return p=function(){return n},n}function w(){let n=(0,f._)(["(?:in)"]);return w=function(){return n},n}function g(){let n=(0,f._)(["(?:let)"]);return g=function(){return n},n}function E(){let n=(0,f._)(["(?:=)"]);return E=function(){return n},n}function _(){let n=(0,f._)(["(?:in)"]);return _=function(){return n},n}function d(){let n=(0,f._)(["(?:fun)"]);return d=function(){return n},n}function T(){let n=(0,f._)(["(?::)"]);return T=function(){return n},n}function A(){let n=(0,f._)(["(?:=>)"]);return A=function(){return n},n}function S(){let n=(0,f._)(["(?:fun)"]);return S=function(){return n},n}function P(){let n=(0,f._)(["(?:=>)"]);return P=function(){return n},n}function N(){let n=(0,f._)(["(?:if)"]);return N=function(){return n},n}function M(){let n=(0,f._)(["(?:then)"]);return M=function(){return n},n}function F(){let n=(0,f._)(["(?:else)"]);return F=function(){return n},n}function R(){let n=(0,f._)(["(?:ins)"],["(?:in\\s)"]);return R=function(){return n},n}function x(){let n=(0,f._)(["(?:funs)"],["(?:fun\\s)"]);return x=function(){return n},n}function y(){let n=(0,f._)(["(?:lets)"],["(?:let\\s)"]);return y=function(){return n},n}function I(){let n=(0,f._)(["(?:matchs)"],["(?:match\\s)"]);return I=function(){return n},n}function k(){let n=(0,f._)(["(?:withs)"],["(?:with\\s)"]);return k=function(){return n},n}function L(){let n=(0,f._)(["(?:ifs)"],["(?:if\\s)"]);return L=function(){return n},n}function b(){let n=(0,f._)(["(?:thens)"],["(?:then\\s)"]);return b=function(){return n},n}function O(){let n=(0,f._)(["(?:elses)"],["(?:else\\s)"]);return O=function(){return n},n}function Y(){let n=(0,f._)(["(?:[a-zA-Z][a-zA-Z0-9]*)"]);return Y=function(){return n},n}function C(){let n=(0,f._)(["(?:?)"],["(?:\\?)"]);return C=function(){return n},n}function D(){let n=(0,f._)(["(?:[0-9]+)"]);return D=function(){return n},n}function B(){let n=(0,f._)(["(?:>=)"]);return B=function(){return n},n}function U(){let n=(0,f._)(["(?:<=)"]);return U=function(){return n},n}function X(){let n=(0,f._)(["(?:+|*|-|/|%|^|<|>|&&|||)"],["(?:\\+|\\*|\\-|\\/|\\%|\\^|<|>|&&|\\|\\|)"]);return X=function(){return n},n}function j(){let n=(0,f._)(["(?:==)"]);return j=function(){return n},n}function q(){let n=(0,f._)(["(?:match)"]);return q=function(){return n},n}function H(){let n=(0,f._)(["(?:with)"]);return H=function(){return n},n}function G(){let n=(0,f._)(["(?:|)"],["(?:\\|)"]);return G=function(){return n},n}function $(){let n=(0,f._)(["(?:nil)"]);return $=function(){return n},n}function z(){let n=(0,f._)(["(?:->)"]);return z=function(){return n},n}function Q(){let n=(0,f._)(["(?:|)"],["(?:\\|)"]);return Q=function(){return n},n}function V(){let n=(0,f._)(["(?:cons)"]);return V=function(){return n},n}function W(){let n=(0,f._)(["(?:->)"]);return W=function(){return n},n}function Z(){let n=(0,f._)(["(?:()"],["(?:\\()"]);return Z=function(){return n},n}function J(){let n=(0,f._)(["(?:))"],["(?:\\))"]);return J=function(){return n},n}function K(){let n=(0,f._)(["(?:->)"]);return K=function(){return n},n}function nn(){let n=(0,f._)(["(?:Bool)"]);return nn=function(){return n},n}function nt(){let n=(0,f._)(["(?:Int)"]);return nt=function(){return n},n}function ne(){let n=(0,f._)(["(?:List)"]);return ne=function(){return n},n}function nr(){let n=(0,f._)(["(?:s*)"],["(?:\\s*)"]);return nr=function(){return n},n}function nu(){let n=(0,f._)(["(?:s+)"],["(?:\\s+)"]);return nu=function(){return n},n}(r=u||(u={})).TOP="TOP",r.TERM_1="TERM_1",r.TERM_2="TERM_2",r.TERM_3="TERM_3",r.TERM_4="TERM_4",r.TERM_5="TERM_5",r.TERM_6="TERM_6",r.TERM_7="TERM_7",r.TERM_8="TERM_8",r.TERM_9="TERM_9",r.TERM_10="TERM_10",r.TERM_11="TERM_11",r.PARENTERM="PARENTERM",r.APPRHS_1="APPRHS_1",r.APPRHS_2="APPRHS_2",r.SINGLES_1="SINGLES_1",r.SINGLES_2="SINGLES_2",r.SINGLES_3="SINGLES_3",r.APP="APP",r.LET="LET",r.LET_NOANN="LET_NOANN",r.FUN="FUN",r.FUN_NOANN="FUN_NOANN",r.IF="IF",r.NAME="NAME",r.HOLE="HOLE",r.INTEGER="INTEGER",r.INFIX_EXPRESSION="INFIX_EXPRESSION",r.INFIX_OP_1="INFIX_OP_1",r.INFIX_OP_2="INFIX_OP_2",r.INFIX_OP_3="INFIX_OP_3",r.EQUALS="EQUALS",r.MATCH="MATCH",r.TYPE_1="TYPE_1",r.TYPE_2="TYPE_2",r.TYPE_3="TYPE_3",r.TYPE_4="TYPE_4",r.TYPE_5="TYPE_5",r.PARENTYPE="PARENTYPE",r.BASE_TYPE_1="BASE_TYPE_1",r.BASE_TYPE_2="BASE_TYPE_2",r.BASE_TYPE_3="BASE_TYPE_3",r.BASE_TYPE_4="BASE_TYPE_4",r.ARROW_TYPE="ARROW_TYPE",r.BOOL="BOOL",r.INT="INT",r.LIST="LIST",r._="_",r.__="__",r.$EOF="$EOF";class na{reset(n){this.pos=n}finished(){return this.pos.overallPos===this.input.length}clearMemos(){this.$scope$TERM$memo.clear()}matchTOP(n,t){return this.run(n,()=>{let e;let r=null;return null!==this.match_(n+1,t)&&null!==(e=this.matchTERM(n+1,t))&&null!==this.match_(n+1,t)&&null!==this.match$EOF(t)&&(r={kind:"TOP",term:e}),r})}matchTERM(n,t){let e=()=>this.choice([()=>this.matchTERM_1(n+1,t),()=>this.matchTERM_2(n+1,t),()=>this.matchTERM_3(n+1,t),()=>this.matchTERM_4(n+1,t),()=>this.matchTERM_5(n+1,t),()=>this.matchTERM_6(n+1,t),()=>this.matchTERM_7(n+1,t),()=>this.matchTERM_8(n+1,t),()=>this.matchTERM_9(n+1,t),()=>this.matchTERM_10(n+1,t),()=>this.matchTERM_11(n+1,t)]),r=this.mark(),u=this.$scope$TERM$memo.get(r.overallPos);if(void 0!==u)return this.reset(u[1]),u[0];let a=this.memoSafe;this.memoSafe=!1,this.$scope$TERM$memo.set(r.overallPos,[null,r]);let i=null,o=r;for(;;){this.reset(r);let n=e(),t=this.mark();if(t.overallPos<=o.overallPos)break;i=n,o=t,this.$scope$TERM$memo.set(r.overallPos,[i,o])}return this.reset(o),this.memoSafe=a,i}matchTERM_1(n,t){return this.matchMATCH(n+1,t)}matchTERM_2(n,t){return this.matchLET(n+1,t)}matchTERM_3(n,t){return this.matchIF(n+1,t)}matchTERM_4(n,t){return this.matchFUN(n+1,t)}matchTERM_5(n,t){return this.matchLET_NOANN(n+1,t)}matchTERM_6(n,t){return this.matchFUN_NOANN(n+1,t)}matchTERM_7(n,t){return this.matchEQUALS(n+1,t)}matchTERM_8(n,t){return this.matchINFIX_EXPRESSION(n+1,t)}matchTERM_9(n,t){return this.matchAPP(n+1,t)}matchTERM_10(n,t){return this.matchSINGLES(n+1,t)}matchTERM_11(n,t){return this.matchPARENTERM(n+1,t)}matchPARENTERM(n,t){return this.run(n,()=>{let e;let r=null;return null!==this.regexAccept(String.raw(s()),"",n+1,t)&&null!==this.match_(n+1,t)&&null!==(e=this.matchTERM(n+1,t))&&null!==this.match_(n+1,t)&&null!==this.regexAccept(String.raw(h()),"",n+1,t)&&(r={kind:"PARENTERM",inside:e}),r})}matchAPPRHS(n,t){return this.choice([()=>this.matchAPPRHS_1(n+1,t),()=>this.matchAPPRHS_2(n+1,t)])}matchAPPRHS_1(n,t){return this.matchSINGLES(n+1,t)}matchAPPRHS_2(n,t){return this.matchPARENTERM(n+1,t)}matchSINGLES(n,t){return this.choice([()=>this.matchSINGLES_1(n+1,t),()=>this.matchSINGLES_2(n+1,t),()=>this.matchSINGLES_3(n+1,t)])}matchSINGLES_1(n,t){return this.matchHOLE(n+1,t)}matchSINGLES_2(n,t){return this.matchNAME(n+1,t)}matchSINGLES_3(n,t){return this.matchINTEGER(n+1,t)}matchAPP(n,t){return this.run(n,()=>{let e,r,u,a;let i=null;return null!==(e=this.mark())&&null!==(r=this.matchTERM(n+1,t))&&null!==this.match__(n+1,t)&&null!==(u=this.matchAPPRHS(n+1,t))&&null!==(a=this.mark())&&(i={kind:"APP",start_pos:e,applicant:r,argument:u,end_pos:a}),i})}matchLET(n,t){return this.run(n,()=>{let e,r,u,a,i,o;let l=null;return null!==(e=this.mark())&&null!==this.regexAccept(String.raw(v()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(r=this.matchNAME(n+1,t))&&null!==this.match__(n+1,t)&&null!==this.regexAccept(String.raw(m()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(u=this.matchTYPE(n+1,t))&&null!==this.match__(n+1,t)&&null!==this.regexAccept(String.raw(p()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(a=this.matchTERM(n+1,t))&&null!==this.match__(n+1,t)&&null!==this.regexAccept(String.raw(w()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(i=this.matchTERM(n+1,t))&&null!==(o=this.mark())&&(l={kind:"LET",start_pos:e,data:r,signature:u,implementation:a,body:i,end_pos:o}),l})}matchLET_NOANN(n,t){return this.run(n,()=>{let e,r,u,a,i;let o=null;return null!==(e=this.mark())&&null!==this.regexAccept(String.raw(g()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(r=this.matchNAME(n+1,t))&&null!==this.match__(n+1,t)&&null!==this.regexAccept(String.raw(E()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(u=this.matchTERM(n+1,t))&&null!==this.match__(n+1,t)&&null!==this.regexAccept(String.raw(_()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(a=this.matchTERM(n+1,t))&&null!==(i=this.mark())&&(o={kind:"LET_NOANN",start_pos:e,data:r,implementation:u,body:a,end_pos:i}),o})}matchFUN(n,t){return this.run(n,()=>{let e,r,u,a,i;let o=null;return null!==(e=this.mark())&&null!==this.regexAccept(String.raw(d()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(r=this.matchNAME(n+1,t))&&null!==this.match__(n+1,t)&&null!==this.regexAccept(String.raw(T()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(u=this.matchTYPE(n+1,t))&&null!==this.match__(n+1,t)&&null!==this.regexAccept(String.raw(A()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(a=this.matchTERM(n+1,t))&&null!==(i=this.mark())&&(o={kind:"FUN",start_pos:e,data:r,domain:u,body:a,end_pos:i}),o})}matchFUN_NOANN(n,t){return this.run(n,()=>{let e,r,u,a;let i=null;return null!==(e=this.mark())&&null!==this.regexAccept(String.raw(S()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(r=this.matchNAME(n+1,t))&&null!==this.match__(n+1,t)&&null!==this.regexAccept(String.raw(P()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(u=this.matchTERM(n+1,t))&&null!==(a=this.mark())&&(i={kind:"FUN_NOANN",start_pos:e,data:r,body:u,end_pos:a}),i})}matchIF(n,t){return this.run(n,()=>{let e,r,u,a,i;let o=null;return null!==(e=this.mark())&&null!==this.regexAccept(String.raw(N()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(r=this.matchTERM(n+1,t))&&null!==this.match__(n+1,t)&&null!==this.regexAccept(String.raw(M()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(u=this.matchTERM(n+1,t))&&null!==this.match__(n+1,t)&&null!==this.regexAccept(String.raw(F()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(a=this.matchTERM(n+1,t))&&null!==(i=this.mark())&&(o={kind:"IF",start_pos:e,cond:r,branch1:u,branch2:a,end_pos:i}),o})}matchNAME(n,t){return this.run(n,()=>{let e,r,u;let a=null;return null!==(e=this.mark())&&null!==this.negate(()=>this.regexAccept(String.raw(R()),"",n+1,t))&&null!==this.negate(()=>this.regexAccept(String.raw(x()),"",n+1,t))&&null!==this.negate(()=>this.regexAccept(String.raw(y()),"",n+1,t))&&null!==this.negate(()=>this.regexAccept(String.raw(I()),"",n+1,t))&&null!==this.negate(()=>this.regexAccept(String.raw(k()),"",n+1,t))&&null!==this.negate(()=>this.regexAccept(String.raw(L()),"",n+1,t))&&null!==this.negate(()=>this.regexAccept(String.raw(b()),"",n+1,t))&&null!==this.negate(()=>this.regexAccept(String.raw(O()),"",n+1,t))&&null!==(r=this.regexAccept(String.raw(Y()),"",n+1,t))&&null!==(u=this.mark())&&(a={kind:"NAME",start_pos:e,data:r,end_pos:u}),a})}matchHOLE(n,t){return this.run(n,()=>{let e,r;let u=null;return null!==(e=this.mark())&&null!==this.regexAccept(String.raw(C()),"",n+1,t)&&null!==(r=this.mark())&&(u={kind:"HOLE",start_pos:e,end_pos:r}),u})}matchINTEGER(n,t){return this.run(n,()=>{let e,r,u;let a=null;return null!==(e=this.mark())&&null!==(r=this.regexAccept(String.raw(D()),"",n+1,t))&&null!==(u=this.mark())&&(a={kind:"INTEGER",start_pos:e,data:r,end_pos:u}),a})}matchINFIX_EXPRESSION(n,t){return this.run(n,()=>{let e,r,u,a,i;let o=null;return null!==(e=this.mark())&&null!==(r=this.matchTERM(n+1,t))&&null!==this.match__(n+1,t)&&null!==(u=this.matchINFIX_OP(n+1,t))&&null!==this.match__(n+1,t)&&null!==(a=this.matchTERM(n+1,t))&&null!==(i=this.mark())&&(o={kind:"INFIX_EXPRESSION",start_pos:e,t1:r,data:u,t2:a,end_pos:i}),o})}matchINFIX_OP(n,t){return this.choice([()=>this.matchINFIX_OP_1(n+1,t),()=>this.matchINFIX_OP_2(n+1,t),()=>this.matchINFIX_OP_3(n+1,t)])}matchINFIX_OP_1(n,t){return this.regexAccept(String.raw(B()),"",n+1,t)}matchINFIX_OP_2(n,t){return this.regexAccept(String.raw(U()),"",n+1,t)}matchINFIX_OP_3(n,t){return this.regexAccept(String.raw(X()),"",n+1,t)}matchEQUALS(n,t){return this.run(n,()=>{let e,r,u,a;let i=null;return null!==(e=this.mark())&&null!==(r=this.matchTERM(n+1,t))&&null!==this.match__(n+1,t)&&null!==this.regexAccept(String.raw(j()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(u=this.matchTERM(n+1,t))&&null!==(a=this.mark())&&(i={kind:"EQUALS",start_pos:e,t1:r,t2:u,end_pos:a}),i})}matchMATCH(n,t){return this.run(n,()=>{let e,r,u,a,i,o,l;let c=null;return null!==(e=this.mark())&&null!==this.regexAccept(String.raw(q()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(r=this.matchTERM(n+1,t))&&null!==this.match__(n+1,t)&&null!==this.regexAccept(String.raw(H()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==this.regexAccept(String.raw(G()),"",n+1,t)&&null!==this.match_(n+1,t)&&null!==this.regexAccept(String.raw($()),"",n+1,t)&&null!==this.match_(n+1,t)&&null!==this.regexAccept(String.raw(z()),"",n+1,t)&&null!==this.match_(n+1,t)&&null!==(u=this.matchTERM(n+1,t))&&null!==this.match_(n+1,t)&&null!==this.regexAccept(String.raw(Q()),"",n+1,t)&&null!==this.match_(n+1,t)&&null!==this.regexAccept(String.raw(V()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(a=this.matchNAME(n+1,t))&&null!==this.match__(n+1,t)&&null!==(i=this.matchNAME(n+1,t))&&null!==this.match_(n+1,t)&&null!==this.regexAccept(String.raw(W()),"",n+1,t)&&null!==this.match_(n+1,t)&&null!==(o=this.matchTERM(n+1,t))&&null!==(l=this.mark())&&(c={kind:"MATCH",start_pos:e,l:r,nilcase:u,data:a,data2:i,t2:o,end_pos:l}),c})}matchTYPE(n,t){return this.choice([()=>this.matchTYPE_1(n+1,t),()=>this.matchTYPE_2(n+1,t),()=>this.matchTYPE_3(n+1,t),()=>this.matchTYPE_4(n+1,t),()=>this.matchTYPE_5(n+1,t)])}matchTYPE_1(n,t){return this.matchARROW_TYPE(n+1,t)}matchTYPE_2(n,t){return this.matchBOOL(n+1,t)}matchTYPE_3(n,t){return this.matchINT(n+1,t)}matchTYPE_4(n,t){return this.matchLIST(n+1,t)}matchTYPE_5(n,t){return this.matchPARENTYPE(n+1,t)}matchPARENTYPE(n,t){return this.run(n,()=>{let e;let r=null;return null!==this.regexAccept(String.raw(Z()),"",n+1,t)&&null!==this.match_(n+1,t)&&null!==(e=this.matchTYPE(n+1,t))&&null!==this.match_(n+1,t)&&null!==this.regexAccept(String.raw(J()),"",n+1,t)&&(r={kind:"PARENTYPE",inside:e}),r})}matchBASE_TYPE(n,t){return this.choice([()=>this.matchBASE_TYPE_1(n+1,t),()=>this.matchBASE_TYPE_2(n+1,t),()=>this.matchBASE_TYPE_3(n+1,t),()=>this.matchBASE_TYPE_4(n+1,t)])}matchBASE_TYPE_1(n,t){return this.matchBOOL(n+1,t)}matchBASE_TYPE_2(n,t){return this.matchINT(n+1,t)}matchBASE_TYPE_3(n,t){return this.matchLIST(n+1,t)}matchBASE_TYPE_4(n,t){return this.matchPARENTYPE(n+1,t)}matchARROW_TYPE(n,t){return this.run(n,()=>{let e,r,u,a;let i=null;return null!==(e=this.mark())&&null!==(r=this.matchBASE_TYPE(n+1,t))&&null!==this.match_(n+1,t)&&null!==this.regexAccept(String.raw(K()),"",n+1,t)&&null!==this.match_(n+1,t)&&null!==(u=this.matchTYPE(n+1,t))&&null!==(a=this.mark())&&(i={kind:"ARROW_TYPE",start_pos:e,domain:r,codomain:u,end_pos:a}),i})}matchBOOL(n,t){return this.run(n,()=>{let e,r;let u=null;return null!==(e=this.mark())&&null!==this.regexAccept(String.raw(nn()),"",n+1,t)&&null!==(r=this.mark())&&(u={kind:"BOOL",start_pos:e,end_pos:r}),u})}matchINT(n,t){return this.run(n,()=>{let e,r;let u=null;return null!==(e=this.mark())&&null!==this.regexAccept(String.raw(nt()),"",n+1,t)&&null!==(r=this.mark())&&(u={kind:"INT",start_pos:e,end_pos:r}),u})}matchLIST(n,t){return this.run(n,()=>{let e,r,u;let a=null;return null!==(e=this.mark())&&null!==this.regexAccept(String.raw(ne()),"",n+1,t)&&null!==this.match__(n+1,t)&&null!==(r=this.matchBASE_TYPE(n+1,t))&&null!==(u=this.mark())&&(a={kind:"LIST",start_pos:e,domain:r,end_pos:u}),a})}match_(n,t){return this.regexAccept(String.raw(nr()),"",n+1,t)}match__(n,t){return this.regexAccept(String.raw(nu()),"",n+1,t)}test(){let n=this.mark(),t=this.matchTOP(0);return this.reset(n),null!==t}parse(){let n=this.mark(),t=this.matchTOP(0);if(t)return{ast:t,errs:[]};this.reset(n);let e=new no;this.clearMemos(),this.matchTOP(0,e);let r=e.getErr();return{ast:t,errs:null!==r?[r]:[]}}mark(){return this.pos}loopPlus(n){return this.loop(n,1,-1)}loop(n,t,e){let r=this.mark(),u=[];for(;-1===e||u.length<e;){let t=this.mark(),e=n();if(null===e||this.pos.overallPos===t.overallPos)break;u.push(e)}return u.length>=t?u:(this.reset(r),null)}run(n,t){let e=this.mark(),r=t();return null!==r?r:(this.reset(e),null)}choice(n){for(let t of n){let n=t();if(null!==n)return n}return null}regexAccept(n,t,e,r){return this.run(e,()=>{let e=RegExp(n,"y"+t),u=this.mark();e.lastIndex=u.overallPos;let a=this.tryConsume(e);return r&&r.record(u,a,{kind:"RegexMatch",literal:n.substring(3,n.length-1),negated:this.negating}),a})}tryConsume(n){let t=n.exec(this.input);if(t){let e=0,r=-1;for(let n=0;n<t[0].length;++n)"\n"===t[0][n]&&(++e,r=n);return this.pos={overallPos:n.lastIndex,line:this.pos.line+e,offset:-1===r?this.pos.offset+t[0].length:t[0].length-r-1},t[0]}return null}noConsume(n){let t=this.mark(),e=n();return this.reset(t),e}negate(n){let t=this.mark(),e=this.negating;this.negating=!e;let r=n();return this.negating=e,this.reset(t),null===r||null}memoise(n,t){let e=this.mark(),r=t.get(e.overallPos);if(this.memoSafe&&void 0!==r)return this.reset(r[1]),r[0];let u=n();return this.memoSafe&&t.set(e.overallPos,[u,this.mark()]),u}match$EOF(n){let t=this.finished()?{kind:"$EOF"}:null;return n&&n.record(this.mark(),t,{kind:"EOF",negated:this.negating}),t}constructor(n){this.negating=!1,this.memoSafe=!0,this.$scope$TERM$memo=new Map,this.pos={overallPos:0,line:1,offset:0},this.input=n}}class ni{toString(){return"Syntax Error at line ".concat(this.pos.line,":").concat(this.pos.offset,". Expected one of ").concat(this.expmatches.map(n=>"EOF"===n.kind?" EOF":" ".concat(n.negated?"not ":"","'").concat(n.literal,"'")))}constructor(n,t){this.pos=n,this.expmatches=[...t]}}class no{record(n,t,e){null===t!==e.negated&&(n.overallPos>this.mxpos.overallPos&&(this.mxpos=n,this.pmatches=[],this.regexset.clear()),this.mxpos.overallPos===n.overallPos&&("RegexMatch"===e.kind?(this.regexset.has(e.literal)||this.pmatches.push(e),this.regexset.add(e.literal)):this.pmatches.push(e)))}getErr(){return -1!==this.mxpos.overallPos?new ni(this.mxpos,this.pmatches):null}constructor(){this.mxpos={overallPos:-1,line:-1,offset:-1},this.regexset=new Set,this.pmatches=[]}}var nl=e(3626);let nc="a text editor",nf={id:"fp"},ns={keywords:["fun","let","in","if","then","else","true","false","match","with"],tokenizer:{root:[[/@?[a-zA-Z][\w$]*/,{cases:{"@keywords":"keyword","@default":"variable"}}],[/[0-9]/,"number"],[/".*?"/,"string"],[/\/\/.*$/,"comment"]]}},nh={base:"vs",inherit:!0,rules:[],colors:{}};function nv(n){function t(n){return"string"==typeof n?n:n.data?t(n.data):""}return{label:n.kind,dataa:t(n),dataa2:"string"==typeof n?n:n.data2?t(n.data2):"",kids:(function(n){if(!n.kind)throw"error: bad input";var t=[];for(var e in n)"kind"!==e&&"start_pos"!==e&&"end_pos"!==e&&"data"!==e&&"data2"!==e&&t.push(n[e]);return t})(n).map(nv),start_pos:n.start_pos,end_pos:n.end_pos}}function nm(){let n=(0,c.useRef)(null),t=(0,l.Ik)();(0,c.useEffect)(()=>{null!==t&&(t.languages.register(nf),t.languages.setMonarchTokensProvider("fp",ns),t.editor.defineTheme("fp-theme",nh))},[]);let[e,r]=(0,c.useState)(!1),[u,i]=(0,c.useState)(void 0),[f,s]=(0,c.useState)([]);function h(n){s(t=>[...t,n])}async function v(){if(s([]),null===t){h({case:"bug",value:"monaco === null"});return}if(null===n.current){h({case:"bug",value:"editor_ref.current === null"});return}let e=encodeURIComponent(n.current.getValue());try{await navigator.clipboard.writeText(e),h({case:"info",value:"URI encoding copied to clipboard."})}catch(n){h({case:"bug",value:n.toString()})}}return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(o(),{children:[(0,a.jsx)("title",{children:nc}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,a.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,a.jsxs)("main",{style:{backgroundColor:"white",color:"black",height:"100%",padding:"1em",display:"flex",gap:"1em",flexDirection:"column"},children:[(0,a.jsx)("div",{style:{fontSize:"2em"},children:nc}),(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"1em"},children:[(0,a.jsx)("button",{onClick:function(){var e;if(s([]),i(void 0),r(!1),null===t){h({case:"bug",value:"monaco === null"});return}if(null===n.current){h({case:"bug",value:"editor_ref.current === null"});return}let u=new na(n.current.getValue()).parse();null===u.ast?h({case:"parse-error",value:u.errs.toString()}):h({case:"parse-result",value:JSON.stringify(u.ast)});let a=[];for(let n of u.errs){let t=n.toString();a.push({severity:8,message:t,startLineNumber:n.pos.line,startColumn:n.pos.offset,endLineNumber:n.pos.line,endColumn:n.pos.offset+1})}if(null!==u.ast&&i(u.ast),null!==u.ast){let n=nl.x(nv(u.ast));for(let t of(void 0===n.find(n=>"error"==n.severity)&&r(!0),n))a.push({severity:(()=>{switch(t.severity){case"warning":return 4;case"error":return 8;default:throw Error("unknown typecheck severity: ".concat(t.severity))}})(),message:t.msg,startLineNumber:t.start_pos.line,startColumn:t.start_pos.offset,endLineNumber:t.end_pos.line,endColumn:t.end_pos.offset}),h({case:"type-error",value:t.msg})}t.editor.setModelMarkers(null===(e=n.current)||void 0===e?void 0:e.getModel(),"owner",a)},children:"Check"}),(0,a.jsx)("button",{onClick:function(){let n;if(s([]),void 0===u||!e){h({case:"user-error",value:"The program must be successfully checked before it is run."});return}void 0!==(n=nl.k(nv(u)))&&h({case:"eval-result",value:n})},children:"Run"}),(0,a.jsx)("button",{onClick:v,children:"Encode"})]}),(0,a.jsx)("div",{style:{display:"inline-block",boxShadow:"0 0 0 1px black"},children:(0,a.jsx)(l.ML,{language:"fp",theme:"fp-theme",value:"?",onMount:function(t,e){n.current=t,console.log("editor_ref.current === null",null===n.current);let r=new URLSearchParams(window.location.search).get("program");if(null!==r){if(s([]),null===e){h({case:"bug",value:"monaco === null"});return}if(null===n.current){h({case:"bug",value:"editor_ref.current === null"});return}t.setValue(r)}},height:"20em",options:{minimap:{enabled:!1}},width:"40em"})}),(0,a.jsxs)("table",{style:{width:"40em",borderCollapse:"separate",borderSpacing:"0.5em"},children:[(0,a.jsx)("thead",{}),(0,a.jsx)("tbody",{children:f.map((n,t)=>{let e=(()=>{switch(n.case){case"parse-error":case"type-error":case"user-error":return"red";case"parse-result":return"green";case"eval-result":return"blue";case"bug":return"pink";case"info":return"black"}})();return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{style:{verticalAlign:"top",textAlign:"center",width:"8em"},children:(0,a.jsx)("div",{style:{backgroundColor:e,color:"white",padding:"0.5em",whiteSpace:"nowrap",border:"0.2em solid ".concat(e)},children:n.case})}),(0,a.jsx)("td",{style:{border:"0.2em solid ".concat(e)},children:(0,a.jsx)("div",{style:{padding:"0.5em"},children:n.value})})]},t)})})]})]})]})}}},function(n){n.O(0,[476,637,16,744],function(){return n(n.s=7653)}),_N_E=n.O()}]);